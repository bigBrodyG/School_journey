# MAPPA PRECISA DELLA MEMORIA - simple_v2 (analisi reale, dettagliata)

**NOTE:** Esecuzione con ASLR disabilitato (setarch -R) per indirizzi ripetibili.


## Sezioni ELF (readelf -S)



## Symbol table (estratta da readelf -s / nm)


- _init                addr=0x0000000000401000 size=0x0 (0 bytes)

- _start               addr=0x00000000004010b0 size=0x38 (56 bytes)

- _dl_relocate_static_pie addr=0x00000000004010e0 size=0x0 (0 bytes)

- add_cc               addr=0x0000000000401196 size=0x241 (577 bytes)

- printrub             addr=0x0000000000401287 size=0x100 (256 bytes)

- memoryLayout         addr=0x00000000004012eb size=0x298 (664 bytes)

- main                 addr=0x0000000000401415 size=0x264 (612 bytes)

- _fini                addr=0x0000000000401520 size=0x0 (0 bytes)

- data_start           addr=0x0000000000404040 size=0x0 (0 bytes)

- exename              addr=0x0000000000404050 size=0x8 (8 bytes)

- tot_cc               addr=0x0000000000404080 size=0x4 (4 bytes)

- rubr_dyn             addr=0x00000000004040a0 size=0x800 (2048 bytes)


## Indirizzi runtime catturati (output del programma)


- memoryLayout: 0x00000000004012eb

- exename_addr: 0x0000000000402008

- exename_val: Rubrica Telefonica

- tot_cc_addr: 0x0000000000404080

- tot_cc_val: 0x0000000000000003

- rubr_dyn_slot: 0x00000000004040a0

- rubr_dyn0_val: 0x0000000000406320

- stack_local_var: 0x00007fffffffe314

- heap_rubr_dyn0: 0x0000000000406320

- heap_rubr_dyn0_val: Mario - 3331234567


## Dump GDB (registers + memory near RBP/RSP + rubr_dyn array)


GDB raw (estratto):


```

$1 = 0x7fffffffe270
$2 = 0x7fffffffe260
$3 = 0x4012f3
0x7fffffffe270:	0x00007fffffffe2d0	0x00000000004014ca
0x7fffffffe280:	0x0000008e00000006	0x0000000000000003
0x7fffffffe290:	0x000000000040215b	0x0000000000402161
0x7fffffffe2a0:	0x0000000000402166	0x0000000000000000
0x7fffffffe2b0:	0x000000000040216b	0x0000000000402176
0x7fffffffe2c0:	0x0000000000402181	0xb33482d73be66100
0x7fffffffe2d0:	0x00007fffffffe370	0x00007ffff7c27675
0x7fffffffe2e0:	0x00007ffff7fc2000	0x00007fffffffe3f8
0x7fffffffe2f0:	0x00000001ffffe330	0x0000000000401415
0x7fffffffe300:	0x0000000000000000	0x517114dc26ff3eae
0x7fffffffe310:	0x00007fffffffe3f8	0x0000000000000001
0x7fffffffe320:	0x00007ffff7ffd000	0x0000000000403df0
0x7fffffffe330:	0x517114dc25df3eae	0x517104a70c413eae
0x7fffffffe340:	0x00007fff00000000	0x0000000000000000
0x7fffffffe350:	0x0000000000000000	0x0000000000000000
0x7fffffffe360:	0x00007fffffffe3f8	0xb33482d73be66100
0x7fffffffe370:	0x00007fffffffe3d0	0x00007ffff7c27729
0x7fffffffe380:	0x00007fffffffe408	0x0000000000403df0
0x7fffffffe390:	0x0000000000401415	0x00007fffffffe408
0x7fffffffe3a0:	0x0000000000000000	0x0000000000000000
0x7fffffffe3b0:	0x00000000004010b0	0x00007fffffffe3f0
0x7fffffffe3c0:	0x0000000000000000	0x0000000000000000
0x7fffffffe3d0:	0x0000000000000000	0x00000000004010d5
0x7fffffffe3e0:	0x00007fffffffe3e8	0x0000000000000038
0x7fffffffe3f0:	0x0000000000000001	0x00007fffffffe775
0x7fffffffe400:	0x0000000000000000	0x00007fffffffe7d2
0x7fffffffe410:	0x00007fffffffe7e6	0x00007fffffffe7fa
0x7fffffffe420:	0x00007fffffffe810	0x00007fffffffe824
0x7fffffffe430:	0x00007fffffffe83c	0x00007fffffffe850
0x7fffffffe440:	0x00007fffffffe88e	0x00007fffffffe8a1
0x7fffffffe450:	0x00007fffffffe8d4	0x00007fffffffe988
0x7fffffffe460:	0x00007fffffffe99c	0x00007fffffffe9b1
0x7fffffffe260:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe268:	0x00	0x61	0xe6	0x3b	0x03	0x00	0x00	0x00
0x7fffffffe270:	0xd0	0xe2	0xff	0xff	0xff	0x7f	0x00	0x00
0x7fffffffe278:	0xca	0x14	0x40	0x00	0x00	0x00	0x00	0x00
0x7fffffffe280:	0x06	0x00	0x00	0x00	0x8e	0x00	0x00	0x00
0x7fffffffe288:	0x03	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe290:	0x5b	0x21	0x40	0x00	0x00	0x00	0x00	0x00
0x7fffffffe298:	0x61	0x21	0x40	0x00	0x00	0x00	0x00	0x00
0x7fffffffe2a0:	0x66	0x21	0x40	0x00	0x00	0x00	0x00	0x00
0x7fffffffe2a8:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe2b0:	0x6b	0x21	0x40	0x00	0x00	0x00	0x00	0x00
0x7fffffffe2b8:	0x76	0x21	0x40	0x00	0x00	0x00	0x00	0x00
0x7fffffffe2c0:	0x81	0x21	0x40	0x00	0x00	0x00	0x00	0x00
0x7fffffffe2c8:	0x00	0x61	0xe6	0x3b	0xd7	0x82	0x34	0xb3
0x7fffffffe2d0:	0x70	0xe3	0xff	0xff	0xff	0x7f	0x00	0x00
0x7fffffffe2d8:	0x75	0x76	0xc2	0xf7	0xff	0x7f	0x00	0x00
0x7fffffffe2e0:	0x00	0x20	0xfc	0xf7	0xff	0x7f	0x00	0x00
0x7fffffffe2e8:	0xf8	0xe3	0xff	0xff	0xff	0x7f	0x00	0x00
0x7fffffffe2f0:	0x30	0xe3	0xff	0xff	0x01	0x00	0x00	0x00
0x7fffffffe2f8:	0x15	0x14	0x40	0x00	0x00	0x00	0x00	0x00
0x7fffffffe300:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe308:	0xae	0x3e	0xff	0x26	0xdc	0x14	0x71	0x51
0x7fffffffe310:	0xf8	0xe3	0xff	0xff	0xff	0x7f	0x00	0x00
0x7fffffffe318:	0x01	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe320:	0x00	0xd0	0xff	0xf7	0xff	0x7f	0x00	0x00
0x7fffffffe328:	0xf0	0x3d	0x40	0x00	0x00	0x00	0x00	0x00
0x7fffffffe330:	0xae	0x3e	0xdf	0x25	0xdc	0x14	0x71	0x51
0x7fffffffe338:	0xae	0x3e	0x41	0x0c	0xa7	0x04	0x71	0x51
0x7fffffffe340:	0x00	0x00	0x00	0x00	0xff	0x7f	0x00	0x00
0x7fffffffe348:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe350:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x7fffffffe358:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
$4 = (const char **) 0x404050 <exename>
$5 = 0x402008 "Rubrica Telefonica"
$8 = (char *(*)[100]) 0x4040a0 <rubr_dyn>
0x4040a0 <rubr_dyn>:	0x0000000000406320	0x0000000000406340
0x4040b0 <rubr_dyn+16>:	0x0000000000406360	0x0000000000000000
0x4040c0 <rubr_dyn+32>:	0x0000000000000000	0x0000000000000000
0x4040d0 <rubr_dyn+48>:	0x0000000000000000	0x0000000000000000
0x4040e0 <rubr_dyn+64>:	0x0000000000000000	0x0000000000000000
0x4040f0 <rubr_dyn+80>:	0x0000000000000000	0x0000000000000000
0x404100 <rubr_dyn+96>:	0x0000000000000000	0x0000000000000000
0x404110 <rubr_dyn+112>:	0x0000000000000000	0x0000000000000000
=== strings at rubr_dyn[0..4] ===
$9 = 0x406320 "Mario - 3331234567"
$10 = 0x406340 "Anna - 3209876543"
$11 = 0x406360 "Luca - 3485554433"
$12 = 0x0
$13 = 0x0
rubr_dyn[0] -> Mario - 3331234567
rubr_dyn[1] -> Anna - 3209876543
rubr_dyn[2] -> Luca - 3485554433
.rodata exename (stringa): 0x402008 -> Rubrica Telefonica
.bss    rubr_dyn[0] (slot): 0x4040a0 -> 0x406320
heap  rubr_dyn[0]: 0x406320 -> Mario - 3331234567

```


## .rodata — offset, addr, string (estratto da rodata_hexdump.txt)


- offset 0x0 -> "........Rubrica "

- offset 0x10 -> "Telefonica.%s - "

- offset 0x20 -> "%s..--- Rubrica "

- offset 0x30 -> "---.rubr_dyn[%d]"

- offset 0x40 -> " -> %s...--- Mem"

- offset 0x50 -> "ory Layout ---.."

- offset 0x60 -> ".text  funzione "

- offset 0x70 -> "memoryLayout: %p"

- offset 0x80 -> ".........rodata "

- offset 0x90 -> "exename (stringa"

- offset 0xa0 -> "): %p -> %s...da"

- offset 0xb0 -> "ta   &tot_cc: %p"

- offset 0xc0 -> " -> %d...bss    "

- offset 0xd0 -> "rubr_dyn[0] (slo"

- offset 0xe0 -> "t): %p -> %p..st"

- offset 0xf0 -> "ack  &local_var:"

- offset 0x100 -> " %p..heap  rubr_"

- offset 0x110 -> "dyn[0]: %p -> %s"

- offset 0x120 -> "........heap  ru"

- offset 0x130 -> "br_dyn[0]: non a"

- offset 0x140 -> "ncora allocato.."

- offset 0x150 -> "... %s ....Mario"

- offset 0x160 -> ".Anna.Luca.33312"


## Layout .data / .bss per rubr_dyn


- rubr_dyn base address (symbol): 0x00000000004040a0

| idx | slot addr | value (ptr) | ascii if available |

|---:|:----------:|:-----------:|:------------------|

|  0 | 0x00000000004040a0 | unknown |  |

|  1 | 0x00000000004040a8 | unknown |  |

|  2 | 0x00000000004040b0 | unknown |  |

|  3 | 0x00000000004040b8 | unknown |  |

|  4 | 0x00000000004040c0 | unknown |  |

|  5 | 0x00000000004040c8 | unknown |  |

|  6 | 0x00000000004040d0 | unknown |  |

|  7 | 0x00000000004040d8 | unknown |  |

|  8 | 0x00000000004040e0 | unknown |  |

|  9 | 0x00000000004040e8 | unknown |  |

| 10 | 0x00000000004040f0 | unknown |  |

| 11 | 0x00000000004040f8 | unknown |  |

| 12 | 0x0000000000404100 | unknown |  |

| 13 | 0x0000000000404108 | unknown |  |

| 14 | 0x0000000000404110 | unknown |  |

| 15 | 0x0000000000404118 | unknown |  |


## Heap allocations (malloc) — indirizzi rilevati a runtime


- heap at 0x0000000000406320 -> Mario - 3331234567


## Stack frame (reconstruction best-effort)


- RBP: 0x00007fffffffe270

  - [rbp] = saved RBP -> 0x00007fffffffe2d0

  - [rbp+8] = return address -> 0x00000000004014ca
